name: CI - Continuous Integration

on:
  push:
    branches: [ main, develop, feature/** ]
  pull_request:
    branches: [ main, develop ]

jobs:
  lint-and-build:
    name: Lint & Build
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸŸ¢ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20.x'
          cache: 'npm'

      - name: ğŸ“¦ Install
        run: npm ci --legacy-peer-deps

      - name: ğŸ” Lint JS
        run: npm run lint:js
        continue-on-error: true

      - name: ğŸ” Lint SCSS
        run: npm run lint:scss
        continue-on-error: true

      - name: ğŸ—ï¸ Build
        run: npm run build

      - name: âœ… Verify Output
        run: |
          echo "âœ… Verifying build output..."
          
          test -f dist/js/viks.js || exit 1
          test -f dist/js/viks.min.js || exit 1
          test -f dist/css/viks.css || exit 1
          test -f dist/css/viks.min.css || exit 1
          test -f dist/js/viks.js.map || exit 1
          test -f dist/js/viks.min.js.map || exit 1
          test -f dist/css/viks.css.map || exit 1
          test -f dist/css/viks.min.css.map || exit 1
          
          echo "âœ“ viks.js exists"
          echo "âœ“ viks.min.js exists"
          echo "âœ“ viks.css exists"
          echo "âœ“ viks.min.css exists"
          echo "âœ“ viks.js.map exists"
          echo "âœ“ viks.min.js.map exists"
          echo "âœ“ viks.css.map exists"
          echo "âœ“ viks.min.css.map exists"
          
          echo "âœ… All files generated successfully!"